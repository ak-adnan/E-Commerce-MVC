@{
    ViewData["Title"] = "Home Page";
}
@model List<Product>

@{
    bool userIsLoggedIn = User.Identity.IsAuthenticated;
    <script>
        var userIsLoggedIn = @userIsLoggedIn.ToString().ToLower();
    </script>
}

<!-- Your view content here -->

<form class="d-flex mx-auto mt-4 mb-3">
    <div class="input-group">
        <input class="form-control border-2 border-primary rounded-pill bg-light text-dark" type="search" placeholder="Search" aria-label="Search">
        <span class="input-group-text bg-primary border border-primary rounded-pill">
            <i class="bi bi-search text-light"></i>
        </span>
    </div>
</form>



<!-- Carousel Section -->
<div class="container text-center mt-4">
    <div id="productCarousel" class="carousel carousel-dark slide" data-bs-ride="carousel" style="max-width: 1300px; margin: 0 auto;">
        <div class="carousel-inner">
            <!-- Carousel Items -->
            <div class="carousel-item active">
                <img src="images/c1.jpg" class="d-block w-100" alt="Product 1">
            </div>
            <div class="carousel-item">
                <img src="images/c2.jpg" class="d-block w-100" alt="Product 2">
            </div>
            <div class="carousel-item">
                <img src="images/c3.jpg" class="d-block w-100" alt="Product 3">
            </div>
        </div>
        <!-- Carousel Controls -->
        <button class="carousel-control-prev" type="button" data-bs-target="#productCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#productCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>
</div>



@* product section here -->> *@


<div class="w-100 mt-4 d-flex flex-wrap">
    @foreach (var product in Model)
    {
        <div class="card mx-2 mb-4" style="width: 19rem;">
            <!-- Apply fixed width and height to the image -->
            <img src="@product.ImageUrl" class="card-img-top mt-2" alt="@product.Name" style="width: 250px; height: 250px;">
            <div class="card-body">
               
                <div class="mb-5">
                    <h5 class="card-title" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 100%;">@product.Name</h5>
                    <p class="card-text ">
                    <p>Category: @product.Category.Name</p>
                    <p>Availability: @product.StockQuantity</p>
                    <p>Price(tk): @product.Price</p>
                    </p>
                </div>
                <div class="fixed-bottom">
                    @* <a href="#" class="btn btn-primary onclick="addToCart(@product.Id); return false;">Add to Cart</a> *@
                    <button onclick="addToCart(@product.Id,1);" class="btn btn-primary">Add to Cart</button>


                </div>
            </div>
        </div>
    }
</div>


@section Scripts{
    <script>

        function addToCart(productId, quantity) {
            $.ajax({
                url: '/ShoppingCart/AddToCart',
                method: 'POST',
                data: { productId: productId, quantity: quantity },
                success: function () {
                    // Handle success, e.g., show a success message
                    alert('Product added to the cart');

                    // Update the item count in local storage and in the navbar
                    const count = getCartItemCountFromLocalStorage() + quantity;
                    updateCartItemCountInLocalStorage(count);
                    updateCartItemCount();
                },
                error: function () {
                    // Handle error, e.g., show an error message
                    alert('Failed to add the product to the cart');
                }
            });
        }

    </script>
}


