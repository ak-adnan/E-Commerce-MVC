@{
    ViewData["Title"] = "Home Page";
}
@{
    if (User.IsInRole("Admin"))
    {
        Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
    }
    else
    {
        Layout = "~/Views/Shared/_Layout.cshtml"; // Default layout for non-admin users
    }
}

@model List<Product>

@{
    bool userIsLoggedIn = User.Identity.IsAuthenticated;
    <script>
        var userIsLoggedIn = @userIsLoggedIn.ToString().ToLower();
    </script>
}

@{
    if (!User.IsInRole("Admin"))
    {
        

        <form class="d-flex mx-auto mt-4 mb-3">
            <div class="input-group">
                <input id="searchInput" class="form-control border-2 border-primary rounded-pill bg-light text-dark" type="search" placeholder="Search" aria-label="Search">
            </div>
        </form>



        <!-- Carousel Section -->
        <div class="container text-center mt-4">
            <div id="productCarousel" class="carousel carousel-dark slide" data-bs-ride="carousel" style="max-width: 1300px; margin: 0 auto;">
                <div class="carousel-inner">
                    <!-- Carousel Items -->
                    <div class="carousel-item active">
                        <img src="images/c1.jpg" class="d-block w-100" alt="Product 1">
                    </div>
                    <div class="carousel-item">
                        <img src="images/c2.jpg" class="d-block w-100" alt="Product 2">
                    </div>
                    <div class="carousel-item">
                        <img src="images/c3.jpg" class="d-block w-100" alt="Product 3">
                    </div>
                </div>
                <!-- Carousel Controls -->
                <button class="carousel-control-prev" type="button" data-bs-target="#productCarousel" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#productCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                </button>
            </div>
        </div>


        <div class="banner mt-lg-5 mb-5">
            <h2 style="text-align: center; font-size: 25px;">
                Featured Category
            </h2>
            <h2 style="text-align: center; font-size: 18px;">
                Order from Your Desired Category!
            </h2>

        </div>


        <div class="container flex flex-wrap mt-4">
            <div class="row">
                <div class="col-md-12">
                    <div class="d-flex justify-content-between">
                        <div class="col-md-2 mb-4">
                            <a href="#" class="text-decoration-none text-dark">
                                <div class="custom-card">
                                    <div class="text-center">
                                        <i class=" fa-solid fa-laptop mb-4 mt-5" style="color: #ffd43b ; font-size: 72px"></i>
                                </div>
                                    <div class="card-body">
                                        <h5 class="card-title text-center" style="font-size: 16px">Electronics & Devices</h5>
                                    </div>
                                </div>
                            </a>
                        </div>
                        <div class="col-md-2 mb-4">
                            <a href="#" class="text-decoration-none text-dark">
                                <div class="custom-card">
                                    <div class="text-center">
                                        <i class=" fa-solid fa-hat-cowboy-side mb-4 mt-5" style="color: #ffd43b ; font-size: 72px"></i>
                                    </div>
                                    <div class="card-body">
                                        <h5 class="card-title text-center" style="font-size: 16px">Mens & Boys Fashion</h5>
                                    </div>
                                </div>
                            </a>
                        </div>
                        <div class="col-md-2 mb-4">
                            <a href="#" class="text-decoration-none text-dark">
                                <div class="custom-card">
                                    <div class="text-center">
                                        <i class=" fa-solid fa-vest-patches mb-4 mt-5" style="color: #ffd43b ; font-size: 72px"></i>
                                    </div>
                                    <div class="card-body">
                                        <h5 class="card-title text-center" style="font-size: 16px">Womens & Girls Fashion</h5>
                                    </div>
                                </div>
                            </a>
                        </div>
                        <div class="col-md-2 mb-4">
                            <a href="#" class="text-decoration-none text-dark">
                                <div class="custom-card">
                                    <div class="text-center">
                                        <i class=" fa-solid fa-person-running mb-4 mt-5" style="color: #ffd43b ; font-size: 72px"></i>
                                    </div>
                                    <div class="card-body">
                                        <h5 class="card-title text-center" style="font-size: 16px">Sports & Games</h5>
                                    </div>
                                </div>
                            </a>
                        </div>
                        <div class="col-md-2 mb-4">
                            <a href="#" class="text-decoration-none text-dark">
                                <div class="custom-card">
                                    <div class="text-center">
                                        <i class=" fa-solid fa-hand-fist mb-4 mt-5" style="color: #ffd43b ; font-size: 72px"></i>
                                    </div>
                                    <div class="card-body">
                                        <h5 class="card-title text-center" style="font-size: 16px">Health & Beauty</h5>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>



        <div class="banner mt-lg-5" >
            <h2 style="text-align: center; font-size: 25px;">
                Featured Products
            </h2>
            <h2 style="text-align: center; font-size: 18px;">
                Check & Get Your Desired Product!
            </h2>

        </div>

       

        @* product section here -->> *@


        <div class="w-100 mt-4 d-flex flex-wrap">
            @foreach (var product in Model)
            {
                <div class="card mx-2 mb-4" style="width: 19rem;">
                   
                    <div class="text-center">
                        <img src="@product.ImageUrl" class="card-img-top mt-2" alt="@product.Name" style="width: 250px; height: 250px;">
                    </div>
                    <div class="card-body">

                        <div class="mb-5">
                            <h5 class="card-title" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 100%;">@product.Name</h5>
                            <p class="card-text ">
                            <p>Category: @product.Category.Name</p>
                            <p>Availability: @product.StockQuantity</p>
                            <p>Price(tk): @product.Price</p>
                            </p>
                        </div>
                        <div class="fixed-bottom">
                            
                            <button onclick="addToCart(@product.Id,1);" class="btn btn-primary">Add to Cart</button>


                        </div>
                    </div>
                </div>
            }
        </div>


        @section Scripts{
        <script>

            function addToCart(productId, quantity) {
                $.ajax({
                    url: '/ShoppingCart/AddToCart',
                    method: 'POST',
                    data: { productId: productId, quantity: quantity },
                    success: function () {
         
                        alert('Product added to the cart');

                     
                        const count = getCartItemCountFromLocalStorage() + quantity;
                        updateCartItemCountInLocalStorage(count);
                        updateCartItemCount();
                    },
                    error: function () {
                        
                        alert('Failed to add the product to the cart');
                    }
                });
            }

            // Adding serach functionality
            $(document).ready(function () {
                
                var productCard; 

                $('#searchInput').on('keyup', function (e) {
                    console.log("Key pressed");
                    var searchQuery = $('#searchInput').val().toLowerCase();
                    console.log("Search Query: " + searchQuery);

               

          
                    $('.card').each(function () {
                        var productName = $(this).find('.card-title').text().toLowerCase();
                        productCard = $(this); 

                        console.log("Product Name: " + productName);
                        console.log("Comparison Result: " + productName.includes(searchQuery));

                        if (productName.includes(searchQuery)) {
                            
                            productCard.show();
                        } else {
                            
                            productCard.hide();
                        }
                    });

       
                });


            });

        </script>
        <script src="https://kit.fontawesome.com/e3d8f46d80.js" crossorigin="anonymous"></script>
    }
    }
}




